# Concepts

stablecoins can be minted with NFT as collateral

# requirement

## basic

## listing system

1. 出品者は bid hook を決めることができる
1. bid hook は入札デポジット額、入札キャンセル額、担保額、落札者決定ロジックに影響する  
   see 10_Generalized_listing_deposit.md

### listing

1. 所有している NFT を出品することができる
1. 出品時に bid hook を 1...100 までの数値を決めることができる(default:10, default is global_option)
1. 入札に使うトークンは出品者が BT に基づいて決定する(global_option)
1. 出品する NFT はロックされる
1. 誰も入札がいない場合は、x 回まで自動的で再出品される(global_option)
1. 認証済みの NFT を表示できる
1. 出品時に、最低入札額を決めることができる(min is global_option)
1. 出品者の Sign 以外の場合は、受け付けずログを残すこと

### listing cancel

1. 誰にも入札されていない場合に、出品者は出品キャンセルすることができる
1. 入札されている場合は、出品キャンセルすることはできない
1. 出品キャンセルは出品後 N 秒経過後にしか行えない(global_option)
1. 出品キャンセルすると NFT はロック解除され出品者に返却される
1. 出品者の Sign 以外の場合は、受け付けずログを残すこと

### buy back

1. 出品者は出品されている NFT を買い戻すことができる
1. 買い戻す場合は、入札額 \* (100 + n)%の金額を支払わなければならない(global_option)
1. 買い戻された最上位入札者は、手数料をもらうことができる
1. 買い戻された 2 位以下入札者は、手数料をもらうことができない
1. ロックされた入札トークンは全て払い戻される
1. 出品者の Sign 以外の場合は、受け付けずログを残すこと

### expand listing period

1. 出品者は BT トークンを支払い、オークションの期間を延長することができる(global_option)
1. 出品者が支払った手数料は落札候補者に等分で支払われる
1. 出品者の Sign 以外の場合は、受け付けずログを残すこと

### bid

1. 出品されている NFT を入札することができる
1. 入札するトークンは BT 基準を満たしていないといけない
1. 最低入札額を上回っていないと入札できない
1. トークン p 円分で入札すると d 円分がデポジットされる(計算式 $d=\frac{1}{bid hook}\times p$)
1. 自分が最上位入札の場合にさらに高値を更新したい場合は、再度 Bid する
1. 入札が行われる時に、出品残り時間 N 時間の場合、自動的に n'分出品時間が伸びる(global_option)
1. 入札者と tx の Sign が一致していること、それ以外の場合は、受け付けずログを残すこと

### bid cancel

1. 入札をキャンセルすることができる
1. 自分自身しか入札していない場合は、キャンセルすることができない
1. キャンセルする入札者の入札順位が bid hook 以下の場合は無料で入札キャンセルできる
1. キャンセルする入札者の入札順位が bid hook 以上の場合はキャンセル料計算に基づいたキャンセル料を支払うことで入札キャンセルできる
1. キャンセル料計算式: `MAX{キャンセルしたい入札者のデポジット額 - (総デポジット額 - 出品者が借りている額), 0}`
1. 入札のキャンセルは入札後 X 日後にしか行えない(global_option)
1. 入札キャンセル成立後、X 日後にトークンの払い出される (global_option)
1. 入札をキャンセルされた出品者は清算が起こる可能性がある
1. 入札者かつ tx と入札キャンセル者の Sign が一致していること、それ以外の場合は、受け付けずログを残すこと

### SellingDecision

1. 出品者は入札がある時に落札者を決定することができる
1. 落札者は N 時間以内に入札金額 - デポジット金額を支払う必要がある(global_option)
1. 落札者が期限内に支払わない場合、デポジット金額が徴収される
1. 落札者が期限内に支払わない場合、オークションの期間が X 日延長されオークションが再開される(global_option)
1. 出品者の Sign 以外の場合は、受け付けずログを残すこと

### end listing

1. 出品者はオークションを終了することができる
1. オークションは時間経過で終了する
1. オークションが終了すると、bid hook 位以下のデポジットは返還される
1. オークションが終了すると、bid hook 位以上は落札候補者として扱われる
1. 出品者の Sign 以外の場合は、受け付けずログを残すこと

### pay listing fee

1. 落札候補者は N 時間までにデポジット額を引いた入札額を支払う必要がある (global_option)
1. N 時間経過後、protocol は最上位入札から順番に落札候補者が入札額を支払ったか確認する
1. 確認時に支払っていない落札候補者のデポジット額は徴収される
1. 落札候補者の支払いが確認できたら、それを落札者とする
1. 落札者よりも下の落札候補者のデポジット額は返還する
1. 出品者に支払われる落札価格は、徴収デポジット額 + (入札額 - デポジット額)となる
1. 落札候補者が全員支払わなかった場合は、徴収デポジット額+NFT を出品者に渡す
1. オークションが成立すると、出品者にトークン、落札者に NFT が引き渡される
1. NFT の引き渡しは落札後 X 日経過後 (global_option)
1. Token の引き渡しは落札後 X 日経過後 (global_option)
1. オークションが成立した場合、　価格情報を記録し query で引き出せること
1. 価格情報は NFT,出品者,落札者,落札日時,落札タイプ,入札件数,落札金額を累積で記録すること

### boost staking reward

1. BT が直接借用資産型の場合に、入札すると(入札者がステーキングしている GUU x 2 or N)を限度額にステーキング GUU が増える (global_option)
1. ステーキング GUU が増える期間はオークションが終了するか、入札キャンセルを行うまで

### borrow

1. 直接借用資産型オークションの場合、出品者は入札された bid hook 位以上の総デポジットを限度額とし、protocol から直接借りることができる
1. 出品者は借りたトークンを protocol へ戻すことができる
1. 出品者の Sign 以外の場合は、受け付けずログを残すこと

### CDP

1. 合成資産造成型オークションの場合、出品者は入札された bid hook 位以上の総デポジットを担保とし、それでステーブルトークンを発行できる
1. 出品者は発行したステーブルトークンを protocol へ戻すことができる
1. 出品者の Sign 以外の場合は、受け付けずログを残すこと

### liquidation

1. 入札トークン価値が下がり、発行したステーブルトークンの総額が入札額の 50%を上回った場合、清算するかステーブルトークンを戻して 50％以下にしなければ、NFT が入札者に強制的に支払われることになる
1. 清算が発生している時に、N 時間までにステーブルトークンを戻すか、落札を決めないと罰則が発生する (global_option)
1. 罰則は、出品者に対して、トークンが支払われず、それ以外は落札と同じ流れとなる
1. 罰則時に落札候補者全員が支払わない場合に NFT と徴収デポジットはモジュールが持つ
1. 出品者の Sign 以外の場合は、受け付けずログを残すこと

### BT(Bidding Token)

1. BT はオークションに使用されるトークン基準
1. BT は 2 種類あり、オークションタイプや出品者が stable トークンを発行することにより変更になる。
1. 直接借用資産型オークションの場合、BT は、出品者が指定した単一のトークンになる。 (global_option)
1. 合成資産造成型オークションの場合、BT は、UnUniFi がサポートする任意のトークンを使用できる (global_option)

## expanded

### incentive system

1. 買い戻し発生時に、NFT 作者、外部フロントエンドエンジニア、ecosystem プールにそれぞれ N%のインセンティブが発生する (global_option)
1. 落札時に、NFT 作者、外部フロントエンドエンジニア、ecosystem プールにそれぞれ N%のインセンティブが発生する (global_option)

### vault system

1. 出品した NFT は Vault に格納される
1. 入札に使用したトークンは Vault に格納される
1. NFT を担保に CDP する場合は、vault を経由して行う
1. 落札時の NFT 払い出しは、vault を経由して行う
1. 落札時のトークン払い出しは、vault を経由して行う
1. vault はセキュリティインシデントが起きた時に X によって閉めることができる (global_option)

### saving system

1. vote によって奪われたトークンを取り戻すことができる
1. vote によって奪われた NFT を取り戻すことができる
1. X の権利で IBC チャンネルを閉じることができる (global_option)
1. X の権利で特定の入札トークンの利用取り消すことができる (global_option)
1. X の権利でオークション機能を停止することができる (global_option)

※global_option is defined by genesisjson
